<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Today's Word</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favicon.ico">
</head>
<body>
    <div class="container">
        <h1>üìñ Today's Word</h1>
        
        <div class="word-card">
            <h2 id="content">Loading...</h2>
            <p id="phonetic" class="small">Pronunciation: Loading...</p>
            <p id="definition" class="definition">Meaning: Loading...</p>
            <div class="button-group">
                <button onclick="speakWord('en-US')">üîä US</button>
                <button onclick="speakWord('en-GB')">üîä UK</button>
                <button onclick="loadRandom()">üé≤ Random</button>
                <button onclick="loadNext()">‚û°Ô∏è Next</button>
                <button onclick="share()">üì§ Share</button>
            </div>
        </div>

        <a class="home" href="index.html">üè† Back to Home</a>
    </div>

    <script>
        let words = [];

        async function loadContent() {
            try {
                const response = await fetch("data/word.txt");
                const text = await response.text();
                words = text.split("\n").filter(w => w.trim() !== "");
                
                const today = new Date();
                const index = today.getUTCFullYear() * 100 + today.getUTCDate();
                displayWord(index % words.length);
            } catch (error) {
                document.getElementById("content").innerText = "Error loading word.";
            }
        }

        async function displayWord(index) {
            const word = words[index];
            document.getElementById("content").innerText = word;
            
            try {
                const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
                const data = await response.json();
                
                document.getElementById("definition").innerText = "Meaning: " + (data[0]?.meanings[0]?.definitions[0]?.definition || "No definition found.");
                document.getElementById("phonetic").innerText = "Pronunciation: " + (data[0]?.phonetic || "N/A");
            } catch {
                document.getElementById("definition").innerText = "Meaning: No definition found.";
                document.getElementById("phonetic").innerText = "Pronunciation: N/A";
            }
        }

        function speakWord(lang) {
            const word = document.getElementById("content").innerText;
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = lang;  // ‚úÖ "en-US" (ÎØ∏Íµ≠Ïãù) or "en-GB" (ÏòÅÍµ≠Ïãù)
            speechSynthesis.speak(utterance);
        }

        function loadRandom() {
            const randomIndex = Math.floor(Math.random() * words.length);
            displayWord(randomIndex);
        }

        function loadNext() {
            let index = words.indexOf(document.getElementById("content").innerText);
            index = (index + 1) % words.length;
            displayWord(index);
        }

        function share() {
            const word = document.getElementById("content").innerText;
            const url = window.location.href;
            const text = `Today's Word: ${word} - Learn more at ${url}`;

            if (navigator.share) {
                navigator.share({ title: "Restart English", text, url });
            } else {
                prompt("Copy this link:", url);
            }
        }

        loadContent();
    </script>
</body>
</html>
